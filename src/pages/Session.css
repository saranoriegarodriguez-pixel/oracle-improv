/* src/pages/Session.css */

.session{
  position: relative;
  min-height: calc(100vh - 56px);
  padding: 16px;
  overflow: hidden;
}

.session__wrap{
  position: relative;
  width: min(1180px, 100%);
  margin: 0 auto;
}

.session__top{
  border: 1px solid var(--border);
  border-radius: 16px;
  background: rgba(0,0,0,.18);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
  padding: 14px 14px;
  margin-bottom: 12px;
}

.session__titleRow{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
}

.session__char{
  display:flex;
  align-items:center;
  gap: 10px;
  font-weight: 950;
  letter-spacing: .01em;
  font-size: 16px;
}

.session__right{
  display:flex;
  align-items:center;
  gap: 10px;
  flex-wrap: wrap;
}

.session__timer{
  font-variant-numeric: tabular-nums;
  font-weight: 900;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.26);
}

.session__headerText{
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,.08);
  font-size: 12px;
  line-height: 1.45;
  color: var(--text2);
  opacity: .92;
}

/* =========================================================
   Layout
========================================================= */
.session__body{
  display:grid;
  grid-template-columns: 1fr;
  gap: 12px;
  align-items: stretch;
}

/* =========================================================
   STAGE (imagen entera siempre)
========================================================= */
.session__stage{
  position: relative;
  border: 1px solid var(--border);
  border-radius: 16px;
  background: rgba(0,0,0,.18);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
  overflow: hidden;
  min-height: 540px;
}

/* ✅ pinch/zoom en móvil (solo cuando activas cinema con clase) */
.session__stage--zoomable{
  touch-action: none;
}

/* “marco” para que contain quede bien si hay bandas */
.session__stage::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(900px 520px at 50% -10%, rgba(240,213,138,.10), transparent 60%),
    radial-gradient(800px 520px at 12% 10%, rgba(255,61,166,.12), transparent 58%),
    radial-gradient(760px 480px at 92% 18%, rgba(255,77,109,.10), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.55));
  pointer-events:none;
  opacity: 1;
}

.session__bg{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;

  /* ✅ CLAVE: se ve entera */
  object-fit: contain;
  object-position: center;

  filter: saturate(1.02) contrast(1.02);
  opacity: .96;

  will-change: transform;
  transform: translate3d(0,0,0) scale(1);
}

.session__vignette{
  position: absolute;
  inset: 0;
  pointer-events:none;
  background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.18));
  opacity: .9;
}

/* =========================================================
   Chat flotante (encima de la imagen)
========================================================= */
.session__chatOverlay{
  position: absolute;
  left: 50%;
  bottom: 14px;
  transform: translateX(-50%);
  width: min(760px, calc(100% - 28px));
  z-index: 30;
}

.session__chat{
  position: relative;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 16px;
  background: rgba(10, 8, 14, .55);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
  overflow: hidden;

  display:flex;
  flex-direction: column;
  min-height: 0;
}

.session__list{
  max-height: 260px;
  overflow-y: auto;
  padding: 14px 12px 10px;
  scroll-behavior: smooth;

  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,.16) rgba(255,255,255,.04);
}
.session__list::-webkit-scrollbar{ width: 10px; }
.session__list::-webkit-scrollbar-track{ background: rgba(255,255,255,.04); }
.session__list::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.12);
  border-radius: 10px;
  border: 2px solid rgba(12, 10, 18, .72);
}
.session__list::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,.18); }

/* =========================================================
   Messages + burbujas
========================================================= */
.msg{
  display:flex;
  flex-direction: column;
  margin: 10px 0;
}

.msg--user{ align-items: flex-end; }
.msg--assistant{ align-items: flex-start; }

.msg__name{
  font-size: 12px;
  opacity: .78;
  margin: 0 0 6px 2px;
  letter-spacing: .2px;
  color: var(--text2);
}
.msg--user .msg__name{
  text-align: right;
  margin: 0 2px 6px 0;
}

.bubble{
  max-width: min(640px, 92%);
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.28);
  box-shadow:
    inset 0 0 0 1px rgba(0,0,0,.35),
    0 10px 30px rgba(0,0,0,.25);
  padding: 10px 12px;

  font-size: 13px;
  line-height: 1.50;
  color: var(--text);
  white-space: pre-wrap;
}

.bubble--user{
  border-color: rgba(255,61,166,.22);
  background: linear-gradient(180deg, rgba(255,61,166,.16), rgba(0,0,0,.22));
}

.bubble--assistant{
  border-color: rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(0,0,0,.20));
}

/* =========================================================
   Composer
========================================================= */
.session__composer{
  border-top: 1px solid rgba(255,255,255,.08);
  padding: 10px;
  background: rgba(0,0,0,.18);
  display:flex;
  gap: 10px;
  align-items: center;
}

.session__input{
  flex: 1;
  min-width: 0;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.40);
  color: var(--text);
  outline: none;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,.35);
  height: 44px;
  line-height: 1.2;
}
.session__input::placeholder{ color: rgba(201,194,216,.55); }
.session__input:focus-visible{
  border-color: rgba(255,61,166,.55);
  box-shadow: 0 0 0 3px rgba(255,61,166,.18), inset 0 0 0 1px rgba(0,0,0,.35);
}

/* =========================================================
   Jump to bottom
========================================================= */
.session__toBottom{
  position: absolute;
  right: 12px;
  bottom: 70px;
  z-index: 40;

  border: 1px solid rgba(255,255,255,.14);
  border-radius: 999px;
  padding: 10px 12px;
  background: rgba(12,10,18,.92);
  color: var(--text);
  cursor: pointer;
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
}

/* =========================================================
   Evaluating overlay
========================================================= */
.evalOverlay{
  position: fixed;
  inset: 0;
  z-index: 220;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 18px;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(6px);
}

.evalCard{
  width: min(520px, 100%);
  border-radius: 18px;
  border: 1px solid rgba(240,213,138,.18);
  background: rgba(12, 10, 18, .96);
  box-shadow: var(--shadow);
  padding: 16px 16px 14px;
  text-align: center;
}

.evalTitle{
  font-weight: 950;
  letter-spacing: .01em;
  margin-bottom: 6px;
}

.evalSub{
  font-size: 12px;
  color: var(--text2);
  opacity: .92;
}

.evalDots{
  display:flex;
  gap: 8px;
  justify-content:center;
  margin-top: 12px;
}

.evalDots span{
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: rgba(240,213,138,.70);
  box-shadow: 0 0 0 3px rgba(255,61,166,.10);
  animation: dotPulse 1.05s infinite ease-in-out;
}
.evalDots span:nth-child(2){ animation-delay: .12s; }
.evalDots span:nth-child(3){ animation-delay: .24s; }

@keyframes dotPulse{
  0%, 100%{ transform: translateY(0); opacity: .55; }
  50%{ transform: translateY(-4px); opacity: 1; }
}

@media (prefers-reduced-motion: reduce){
  .evalDots span{ animation: none !important; }
}
